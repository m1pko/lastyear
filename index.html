<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>NDN | Last Year</title>
  <meta name="lastyear" content="Albuns of the Last Year">
  <meta name="Miguel Barba" content="LastYear">

  <link rel="stylesheet" type="text/css" href="css/main_styles.css">
  <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">

	<script type="text/javascript" src="js/json2.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
  <script src="js/modules.js"></script>
  <script src="js/controller.js"></script>

  <!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

</head>

<body ng-app="lastyearApp" ng-controller="formController">

	<script>

	var html = "";
	var once = 0;
	$(document).ready(function() {
	    $.getJSON("http://ws.audioscrobbler.com/2.0/?method=user.gettopalbums&user=micky_1punch_ko&period=12month&limit=5&api_key=8295890448112bd3f26d3bd606610fe2&format=json", function(json) {

	        $.each(json.topalbums.album, function(i, item) {

	        	$.getJSON("http://ws.audioscrobbler.com/2.0/?method=album.getInfo&user=micky_1punch_ko&artist=" + item.artist.name + "&album=" + item.name + "&api_key=8295890448112bd3f26d3bd606610fe2&format=json", function(json_album){

	        		$.each(json_album.album.tags, function(j, item_album){

	        			once = 0;

	        			$.each(item_album, function(k,item_album_child){

	        				if (item_album_child.name == '2015' && once == 0)
		        			{
		        				once++;
		        				html += "<p><a href=" + item.url + " target='_blank'>" + item.artist.name + " - " + item.name + " - " + "Play count : " + item.playcount + " - Year : " + item_album_child.name + "</a></p>";
		        				$('#topAlbumsYear').append(html);
		        				html = "";
		        			}

		        		});	        			
	        		});
	        	});
	        });
	    });
	});

	</script>
	<div class="centerDiv">
		<form name="userForm" ng-submit="submitForm(userForm.$valid)" novalidate>
			<div class="form-group">
				<label>Last.fm User Name</label>
				<input type="text" name="lastfmuser" class="form-control" ng-model="lastfmuser" required>
				<p ng-show="userForm.lastfmuser.$invalid && !userForm.lastfmuser.$pristine" class="help-block">You Last.fm username is required.</p>
			</div>
			<div class="form-group">
				<label>Max Records (1 to 100)</label>
				<input type="text" name="maxrecords" class="form-control" ng-model="maxrecords" ng-pattern="maxrecordsRegexp" required>
			<div />
			<div class="form-group">
				<label>Period</label>
				<select name="period" ng-model="period" class="form-control">
				  <option value="overall">overall</option>
				  <option value="7day">7day</option>
				  <option value="1month">1month</option>
				  <option value="3month">3month</option>
				  <option value="6month">6month</option>
				  <option value="12month">12month</option>
				</select>
			<div/>
			<div class="form-group">
				<br/>
				<button type="submit" class="btn btn-primary" ng-disabled="userForm.$invalid">Submit</button>
			<div />
		</form>
	</div>
	<div id="topAlbumsYear" class="centerDiv"></div>
</body>
</html>